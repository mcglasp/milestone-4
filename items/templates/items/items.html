{% extends "base.html" %}
{% load static %}
{% load price_tools %}

{% block content %}
<div class="container">
    <div class="row">
        <div class="col-12 d-flex justify-content-end">

    </div>
</div>
{% include 'includes/narrow_search_nav.html' %}
    <div class="row">
        {% if items.count is 0 %}
        <p>Oh dear, it looks like there's nothing available. Why not widen your search?</p>
        {% else %}
        {% for item in items %}
        <div class="col-4 item">
            <div class="card">
                <div class="card-body">
                    <a href="{% url 'item_detail' item.id %}">
                        <p><strong>{{ item.title }}</strong></p>
                        <!-- ADD USER CHECK HERE -->
                        <a href="{% url 'update_item' item.id %}">Edit</a> | <a href="{% url 'delete_item' item.id %}">Delete</a>
                    </a>
                    {% for author in item.author.all %}
                    <p><em>{{ author }}</em></p>
                    {% endfor %}
                    <p>
                        Ages: 
                    {% for age in item.age_range.all %}
                    
                    {% if age.age_range == "preschool" %} <span class="badge bg-primary">{{ age }}</span>
                    {% elif age.age_range == "5-7" %} <span class="badge bg-success">{{ age }}</span>
                    {% elif age.age_range == "6-8" %} <span class="badge bg-info">{{ age }}</span>
                    {% elif age.age_range == "8-10" %} <span class="badge bg-warning">{{ age }}</span>
                    {% elif age.age_range == "teen" %} <span class="badge bg-danger">{{ age }}</span>
                    {% endif %}
                    
                    
                    
                    {% endfor %}
                </p>
                    {% if item.set_sale_price != 0.00 %}
                    <p><strike>£{{ item.price }}</strike></p>
                    <p>Sale Price! £{{ item.set_sale_price }}</p>
                    {% elif item.discount > 0 %}
                    <p><strike>£{{ item.price }}</strike></p>
                    <p>{{ item.discount }}% off! £{{ item.price | calc_discount:item.discount }}</p>
                    {% else %}
                    <p>£{{ item.price }}</p>
                    {% endif %}
                    <p class="text-truncate">{{ item.description }}</p>
                    <a href="{% url 'item_detail' item.id %}"><img src="/media/{{ item.image }}"></a>
                </div>
                <div class="card-footer">
                    {% for genre in item.genre.all %}
                    <small class="text-muted">{{ genre.screen_name }}</small>
                    {% if forloop|length > 1 and not forloop.last %} | {% endif %}
                    {% endfor %}
                </div>

            </div>
        </div>
   
        {% endfor %}
        {% endif %}
    </div>
</div>

</script>

{% endblock %}

{% block postloadjs %}

<!-- Code below is based on Code Institue Boutique Ado project -->



{% endblock %}
