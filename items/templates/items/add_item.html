{% extends "base.html" %}
{% load static %}
{% load price_tools %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <div class="col-sm-12 col-md-12 col-lg-12">
            <form method="POST" action="{% url 'add_item' %}" id="item-form" class="form mb-2"
                enctype="multipart/form-data">
                {% csrf_token %}

                <div class="row">
                    <div class="col-6">
                        {{ form.title | as_crispy_field }}
                        <button type="button" id="add_author_1">Add author</button>
                        <input id="id_first_name" type="text">
                        <input id="id_surname" type="text">
                        
                        <select id="id_authors">
                            {% for author in authors_select %}
                            <option value="{{ author }}">{{ author }}</option>
                            {% endfor %}
                        </select>
                        <button type="button" id="add_author_2">Add author</button>
                        <p>Selected Authors</p>
                        <div id="store-authors"></div>
                        <textarea id="hidden-authors" type="textarea" name="authors" style="display: none;"></textarea>

                        {{ form.genre | as_crispy_field }}
                        {{ form.age_range | as_crispy_field }}
                    </div>
                    <div class="col-6">
                        {{ form.description | as_crispy_field }}
                        {{ form.price | as_crispy_field }}
                        {{ form.discount | as_crispy_field }}
                        {{ form.set_sale_price | as_crispy_field }}
                        {{ form.image | as_crispy_field }}
                        Featured?
                        {{ form.featured | as_crispy_field }}
                    </div>
                </div>
                <div class="text-right">
                    <a href="{% url 'items' %}" class="btn btn-outline-black rounded-0">Cancel</a>
                    <button class="btn btn-black rounded 0" id="add-item-btn">Add Book To Shop</button>
                </div>
            </form>
            {% endblock %}
            {% block postloadjs %}
            <script>
                let alreadyInput = []
                $("#add_author_1").click(function (e) {
                    e.preventDefault;
                    let newValue = $("#id_authors").val()
                    let node = document.createElement("span");
                    let alreadyHiddenText = document.getElementById("hidden-authors");
                    let hiddenTextToAdd = document.createTextNode(`${newValue};`)
                    node.innerHTML = newValue
                    alreadyHiddenText.appendChild(hiddenTextToAdd)
                    $(node).attr('class', 'badge rounded-pill bg-light text-dark')
                    $('#store-authors').append(node)
                    alreadyInput.push(newValue)
                    console.log(newValue)
                });

                $("#add_author_2").click(function (e) {
                    e.preventDefault;
                    let valueFirstname = $("#id_first_name").val()
                    let valueSurname = $("#id_surname").val()
                    let newValue = `${valueFirstname} ${valueSurname}`
                    let node = document.createElement("span");
                    let alreadyHiddenText = document.getElementById("hidden-authors");
                    let hiddenTextToAdd = document.createTextNode(`${newValue};`)
                    node.innerHTML = newValue
                    alreadyHiddenText.appendChild(hiddenTextToAdd)
                    $(node).attr('class', 'badge rounded-pill bg-light text-dark')
                    $('#store-authors').append(node)
                    alreadyInput.push(newValue)
                });

              
            </script>
            {% endblock %}